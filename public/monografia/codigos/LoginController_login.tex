\begin{figure}
    \centering
    \begin{lstlisting}[style=phplisting]
        public function onLogin(){
        $validate = $this->validate([
            "email" => "required|valid_email",
            "senha" => "required"
        ]);
        if(!$validate){
            return redirect()->back()->with("errors", $this->validator->getErrors());
        }else{
            $login = $this->usuario->where("email", $this->request->getPost("email"))->first();
            if(!$login){
                return redirect()->back()->with("infoError", "Verifique suas credenciais e tente novamente!");
            }
            if(!password_verify($this->request->getPost("senha"), $login->senha)){
                return redirect()->back()->with("infoError", "Verifique suas credenciais e tente novamente!");
            }
            unset($login->senha);
            session()->set("login",$login);
            return redirect()->route("home.principal");
        }
    }
    \end{lstlisting}
    \caption{Implementação do método de logar}
    \label{cod:loginController}
\end{figure}